Metadata-Version: 2.4
Name: lazylabel
Version: 1.0.0
Summary: A fast, intuitive image segmentation tool using SAM and manual editing.
Author-email: "Deniz N. Cakan" <deniz.n.cakan@gmail.com>
License: MIT License
        
        Copyright (c) 2025 Deniz N. Cakan
        
        Permission is hereby granted, free of charge, to any person obtaining a copy
        of this software and associated documentation files (the "Software"), to deal
        in the Software without restriction, including without limitation the rights
        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
        copies of the Software, and to permit persons to whom the Software is
        furnished to do so, subject to the following conditions:
        
        The above copyright notice and this permission notice shall be included in all
        copies or substantial portions of the Software.
        
        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
        SOFTWARE.
        
Project-URL: Homepage, https://github.com/dnzckn/lazylabel
Project-URL: Bug Tracker, https://github.com/dnzckn/lazylabel/issues
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Topic :: Scientific/Engineering :: Image Processing
Classifier: Environment :: X11 Applications :: Qt
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: PyQt6
Requires-Dist: pyqtdarktheme==2.1.0
Requires-Dist: torch
Requires-Dist: torchvision
Requires-Dist: segment-anything==1.0
Requires-Dist: numpy
Requires-Dist: opencv-python
Requires-Dist: scipy
Requires-Dist: requests
Requires-Dist: tqdm
Dynamic: license-file

# <img src="demo_pictures/logo2.png" alt="LazyLabel Logo" style="height:60px; vertical-align:middle;" /> <img src="demo_pictures/logo_black.png" alt="LazyLabel Cursive" style="height:60px; vertical-align:middle;" />
LazyLabel is a user-friendly, AI-assisted image segmentation tool designed to streamline the process of creating high-quality masks for machine learning datasets. It leverages the power of the Segment Anything Model (SAM) to provide quick and accurate segmentation, while also offering advanced polygon editing capabilities for precise control. Outputs are saved in a clean, one-hot encoded format, making it easy to integrate with your machine learning workflows.

Heavy inspiration from [LabelMe](https://github.com/wkentaro/labelme?tab=readme-ov-file#installation) and [Segment-Anything-UI](https://github.com/branislavhesko/segment-anything-ui/tree/main)

![LazyLabel Screenshot](demo_pictures/gui.PNG)

## ‚ú® Core Features

* **AI-Powered Segmentation**: Simply left-click (positive) and right-click (negative) on an object, and let SAM generate a precise mask for you.
* **Vector Polygon Tool**: Draw, edit, and reshape polygon segments with full control. Drag vertices or move the entire shape in Edit Mode.
* **Advanced Class Management**: Don't just create masks, create *classes*. Assign multiple, distinct segments to a single class ID for organized labeling.
* **Intuitive Editing & Refinement**:
    * **Selection Mode**: Click on any segment to select it for an action.
    * **Class Merging**: Select multiple segments and merge them into a single class with one keystroke.
    * **Drag-and-Drop Reordering**: Easily re-order your class channels before saving just by dragging them in the class list.
* **Interactive UI**: All segments are color-coded by class. The segment list provides at-a-glance information and is sortable. Polygon segments even highlight on hover!
* **Smart I/O**: Automatically detects existing `.npz` masks and loads them. Saves your work in a clean, one-hot encoded format.

## üöÄ Getting Started

1.  **Dependencies**: Runs on `python==3.10`. Install all required Python libraries using the provided `requirements.txt` file in the root directory:
    ```bash
    pip install -r requirements.txt
    ```
2.  **SAM Checkpoint**: Download a SAM model checkpoint file (e.g., `sam_vit_h_4b8939.pth`) and place it in the same directory as the script. Here's a link to the checkpoint:
    - [From META Segment Anything Repo](https://github.com/facebookresearch/segment-anything) [SAM Checkpoint](https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth)

    Alternatively, you can use the `sam_checkpoint` parameter in the `main.py` script to specify a different path.

    If you want to use a different SAM model, just replace the checkpoint file with your desired model.
3.  **Run**: Launch the application with:
    ```bash
    python main.py
    ```

## ‚å®Ô∏è Controls & Keybinds

### Modes
| Key | Action |
|---|---|
| `1` | Enter **Point Mode** (for AI segmentation). |
| `2` | Enter **Polygon Drawing Mode**. |
| `E` | Toggle **Selection Mode** to select existing segments. |
| `R` | Enter **Edit Mode** for selected polygons (drag shape or vertices). |
| `Q` | Toggle **Pan Mode** (click and drag the image). |

### Actions
| Key(s)         | Action                                                                 |
|----------------|------------------------------------------------------------------------|
| `L-Click`      | Add positive point (Point Mode) or polygon vertex.                     |
| `R-Click`      | Add negative point (Point Mode).                                       |
| `Ctrl + Z`     | Undo the last point placed (in Point or Polygon mode).                 |
| `Spacebar`     | Finalize and save the current in-progress AI segment.                  |
| `Enter`        | **Save final mask for the current image to a `.npz` file.**            |
| `M`            | **Merge** selected segments into a single class.                       |
| `V` / `Delete` | **Delete** the currently selected segments.                            |
| `C`            | Clear all temporary points or polygon vertices from the screen.        |
| `W/A/S/D`      | Pan the image up, left, down, or right.                                |
| `Scroll Wheel` | Zoom-in or -out on the image.                                          |

## üì¶ Output Format

LazyLabel saves your work as a compressed NumPy array (`.npz`) with the same name as your image file.

The file contains a single data key, `'mask'`, which holds a **one-hot encoded tensor** with the shape `(H, W, C)`:
* `H`: The height of the image.
* `W`: The width of the image.
* `C`: The total number of unique classes you created.

Each channel in the tensor is a binary mask where a `1` indicates a pixel belonging to that class. All segments you assigned to the same class ID are automatically combined into that single channel, giving you a clean, ML-ready output.

## ‚òï[If you found LazyLabel helpful, consider supporting the project!](https://buymeacoffee.com/dnzckn)‚òï
